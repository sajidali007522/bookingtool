<link type="text/css" rel="stylesheet" href="/assets/css/reservation.css" />

<div class="overlay-bg"></div>

<div class="custom-section-wrap" >
  <h1>Book</h1>
  <div class="custom-section">
    <app-loader *ngIf="state.initiateBooking || state.loadingGroups"></app-loader>
    <ng-container *ngIf="!state.initiateBooking && !state.loadingGroups">
      <div class="custom-sidebar">
        <div class="custom-nav" id="tabsCustom">
          <ul>
            <li *ngFor="let group of state.templateGroups" [ngClass]="{'active': group.name == state.selectedGroup['name']}">
              <a href="javascript:void(0)" (click)="setTemplateGroup(group)"><em class="fa fa-plane"></em> <span>{{group.name}}</span></a>
            </li>
          </ul>
        </div>
      </div>
      <div class="custom-main">
        <div class="row">
          <div class="col-md-6">
            <div class="field-wrap-outer">
              <label>Business Profile*</label>
              <div class="field-wrap">
                <select class="form-control" name="resourceTypeID" [(ngModel)]="form.ResourceTypeID">
                  <option value="{{type.value}}" *ngFor="let type of ruleBags">{{type.text}}</option>
                </select>
                <span class="globel-world-icon" *ngIf="!state.initiateBooking"></span>
                <span class="fa fa-spin fa-spinner" *ngIf="state.initiateBooking"></span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="field-wrap-outer">
              <label>Traveler*</label>

            </div>
          </div>
        </div>
        <ng-container *ngIf="state.loadingTemplate">
          <div class="table-loader">Processing...</div>
        </ng-container>
        <ng-container *ngIf="!state.loadingTemplate">
          <ng-container *ngIf="state.selectedGroup['buildGroup'] != true">
            <div class="row">
              <div class="col-md-12">
                <div class="field-wrap-outer">
                  <label>Template*</label>
                  <div class="field-wrap">
                    <select class="form-control" name="resourceTypeID" [(ngModel)]="form.template" (change)="loadTemplate(form.template)">
                      <option [ngValue]="template.templateID" *ngFor="let template of state.selectedGroup['templates']">{{template.name}}</option>
                    </select>
                    <span class="globel-world-icon" *ngIf="!state.initiateBooking"></span>
                    <span class="fa fa-spin fa-spinner" *ngIf="state.initiateBooking"></span>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="state.selectedGroup['buildGroup'] == true">
            <div class="trip-radio-wrap">
              <div class="custom-control custom-radio custom-control-inline" *ngFor="let template of state.selectedGroup['templates']; let index=index">
                <input type="radio" id="template_{{index}}" [(ngModel)]="form.template" value="{{template.templateID}}" name="template" class="custom-control-input">
                <label class="custom-control-label" (click)="loadTemplate(template.templateID)" for="template_{{index}}">{{template.name}}</label>
              </div>
            </div>
          </ng-container>
          <div class="custom-content tabs-content" id="content-1" style="display: block;" *ngFor="let resource of state.selectedTemplate['resources']; let i = index">
            <div class="book-time-wrap">
              <div class="row">
                <div class="col-6 col-md-6">
                  <div class="field-wrap-outer">
                    <label>Departure Date*</label>
                    <div class="field-wrap">
                      <input type="text"
                             [(ngModel)]="form.BeginDate"
                             bsDatepicker
                             [bsConfig]="bsConfig"
                             (ngModelChange)="setDateTo()"
                             [minDate]="minDateFrom"
                             placeholder="Departure Date"
                             name="departure_date"
                             class="form-control">
                      <span class="fa fa-calendar-o"></span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-6" *ngIf="resource.canSearchByTime">
                  <div class="field-wrap-outer">
                    <label>Departure Time</label>
                    <div class="field-wrap time-picker-wrap">
                      <select class="form-control no-icon">
                        <option value="">9:30 AM</option>
                      </select>
<!--                      <timepicker [(ngModel)]="form.BeginTime"-->
<!--                                  [mousewheel]="true"-->
<!--                                  [arrowkeys]="true"-->
<!--                      ></timepicker>-->
                      <!--                        <input type="text" placeholder="" class="form-control">-->
                      <!--                        <span class="fa fa-clock-o"></span>-->
                    </div>
                  </div>
                </div>

                <div class="col-md-6 col-6">
                  <div class="field-wrap-outer">
                    <label>Return Date*</label>
                    <div class="field-wrap">
                      <input type="text"
                             [(ngModel)]="form.EndDate"
                             bsDatepicker
                             [minDate]="form.BeginDate"
                             [bsConfig]="bsConfig"
                             placeholder="Return Date"
                             name="arrival_date"
                             class="form-control">
                      <span class="fa fa-calendar-o"></span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-6" *ngIf="resource.canSearchByTime">
                  <div class="field-wrap-outer time-picker-wrap">
                    <label>Return Time</label>
                    <div class="field-wrap">
                      <select class="form-control no-icon">
                        <option value="">9:30 AM</option>
                      </select>
<!--                      <timepicker [(ngModel)]="form.EndTime" [mousewheel]="true" [arrowkeys]="true"></timepicker>-->
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <app-form-builder class="col-md-6 col-6" *ngFor="let field of resource['searchFields']; let j =index" [field]="field"
                                  [resourceType]="resource['resourceTypeID']"
                                  [index]="i+'_'+j"
                                  [bookingID] = "form.bookingID"
                ></app-form-builder>
              </div>
            </div>
          </div>
        </ng-container>
        <br/>
        <button type="submit" class="btn btn-info btn-block" [disabled]="state.processing">Search <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>

      </div>
    </ng-container>
  </div>
</div>


<script src="/assets/js/reservation.js" defer></script>
