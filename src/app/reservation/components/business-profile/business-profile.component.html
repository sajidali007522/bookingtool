<link type="text/css" rel="stylesheet" href="/assets/css/reservation.css" />

<div class="overlay-bg"></div>

<div class="custom-section-wrap" >
  <div class="alert alert-primary custom-logo-top no-icon m-0 alert-dismissible fade show" role="alert">
    Business Profile
  </div>
  <div class="custom-section" [ngClass]="{'table-loader': state.processing}">
    <ng-container>
      <div class="custom-main template-outer">
        <ng-container>
          <div class="custom-content tabs-content" id="content-1" style="display: block;">
            <div class="book-time-wrap">
              <div class="row">
                <ng-container *ngFor="let field of formFields; let i = index">

                  <div class="col-md-6 col-12" [ngStyle]="{display: field.visible ? '' : 'none'}">

                      <app-form-fields
                        [field]="field"
                        [definitionType]="1"
                        [form]="form"
                        [resourceType]="'00000000-0000-0000-0000-000000000000'"
                        [index]="-1"
                        [fieldIndex]="i"
                        [bookingID]="state.bookingID"
                        (fieldBinding)="bindField($event)"
                        [hasIcon]="state.processing"
                      >

                      </app-form-fields>
                  </div>
                </ng-container>
              </div>
              <div class="reservation-bot-btns d-flex">
                <a href="javascript:void(0);" class="btn btn-danger" data-toggle="modal" data-target="#exampleModal">
                  Back
                </a>
                <button type="submit" class="btn btn-success ml-auto" (click)="submitForm()" [disabled]="state.processing" >Next <span class="fa fa-angle-right"></span> <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>
              </div>
              <div class="booking-article-bot">
                <a href="javascript:void(0);" *ngIf="!state.bookingContentArea" (click)="toggleBookingContentArea(true);" class="new-booking">
                  <span *ngIf="state.bookedSegments.length>0">{{state.bookedSegments.length}}</span>
                </a>
                <div class="booking-content-area" *ngIf="state.bookingContentArea" style="display:block;">
                  <div class="booking-top" >
                    <a href="javascript:void(0)" class="close-booking" (click)="toggleBookingContentArea(false);"><span class="fa fa-close"></span></a>
                    <div class="booking-art-title"><h3>New Booking</h3></div>
                    <div class="booking-search"><input type="text" placeholder="Search by name" class="form-control"></div>
                  </div>
                  <div class="booking-art-inner">
                    <ul>

                      <ng-container *ngFor="let segment of state.bookedSegments">
                        <li  *ngFor="let seg of segment.segments">
                          <h4>
                            <img src="{{segment.cartPreview.providerLogo}}" width="20"/>{{segment.resourceName}}
                          </h4>
                          <h5><span>{{dateParse.parseDate(seg.beginDate)}}</span></h5>
                          <p>{{seg.from}}</p>
                          <p>{{seg.to}}</p>
                          <div class="booking-subtotal">
                            <span></span> <strong>{{segment.totalPrice}}</strong>
                          </div>
                        </li>
                      </ng-container>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </ng-container>
        <!--<br/>
        <button type="submit" class="btn btn-info btn-block" (click)="submitForm()" [disabled]="state.processing">Next <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>-->

      </div>
      <app-confirm-modal [confirmationMessage]="'Do you want to restart reservation?'" (isConfirmed)="restartReservation($event)"></app-confirm-modal>
    </ng-container>
  </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New Booking</h5><button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true">Ã—</span></button>
      </div>
      <div class="modal-body p-0">
        <div class="modal-topbar form-primary form-grey">
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label>Add Traveler</label>
                <div class="field-icon-wrap">
                  <span class="user field-icon mt-secon"></span>
                  <input type="text" placeholder="Search by last name, first name" class="form-control">
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label>Add / Replace</label>
                <div class="field-icon-wrap">
                  <span class="fa fa-refresh field-icon mt-secon"></span>
                  <select class="form-control">
                    <option>Select Resources</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="custom-accordion-wrap plr-20">
          <div class="custom-accordion">
            <h3 class="has-icons active">
              <a href="javascript:void(0)">Add Room Tues, April 5 - Jan 10</a>
              <div class="custom-acc-icons">
                <span class="#" class="fa fa-trash-o remove-accordion align-self-center"></span>
                <span class="btn btn-info btn-addmore">Add</span>
              </div>
            </h3>
            <div class="custom-accordion-content exp">
              <div class="form-primary">
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label>Date</label>
                      <input class="form-control" type="text" value="">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label>End Date</label>
                      <input class="form-control" type="text" value="">
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label>Site</label>
                      <input class="form-control" type="text" value="">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label>Room Type</label>
                      <input class="form-control" type="text" value="">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label>Contract</label>
                      <input class="form-control" type="text" value="">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="table-cart-wrap">
            <table class="table">
              <ng-container *ngFor="let segment of state.bookedSegments">
                <tr *ngFor="let seg of segment.segments">
                  <td><img src="{{segment.providerLogoUrl.split('.png').join('_30.png')}}" /><strong>{{segment.resourceName}}</strong></td>
                  <td>{{dateParse.parseDate(segment.beginDate)}}</td>
                  <td>{{dateParse.parseDateToTime(seg.beginDate)}}: {{seg.from}}</td>
                  <td>{{dateParse.parseDateToTime(seg.endDate)}}: {{seg.to}} </td>
                  <td><strong>{{segment.priceName}} ${{segment.totalPrice}}</strong></td>
                  <td><a href="javascript:void(0)" class="btn btn-sm btn-outline-info">Remove</a></td>
                </tr>
              </ng-container>

            </table>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" data-dismiss="modal" type="button">Close</button><button class="btn btn-success" type="button">Save</button>
      </div>
    </div>
  </div>
</div>
