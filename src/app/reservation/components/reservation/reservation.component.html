<link type="text/css" rel="stylesheet" href="/assets/css/reservation.css" />


<div class="overlay-bg"></div>
<div class="custom-section-wrap">
  <!-- <h1>Book</h1> -->
  <h1 class="inline-block">
    <span class="custom-logo">ようこそ</span>
    <span class="custom-desc">Welcome Bienvenue Marhaba</span>
  </h1>
  <div class="custom-section">

    <div class="custom-top-section">
      <div class="tagtop">Book</div>
      <div class="row">
        <div class="col-md-6">
          <div class="field-wrap-outer">
            <label>Business Profile*</label>
              <div class="field-wrap">
                  <select class="form-control" name="resourceTypeID" [(ngModel)]="form.ResourceTypeID">
                      <option value="{{type.value}}" *ngFor="let type of ruleBags">{{type.text}}</option>
                  </select>
                  <span class="globel-world-icon" *ngIf="!state.initiateBooking"></span>
                  <span class="fa fa-spin fa-spinner" *ngIf="state.initiateBooking"></span>
              </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="field-wrap-outer">
            <label>Traveler*</label>
              <div class="field-wrap field-gray-wrap traveler-field mb-0">
                  <span class="user"></span>
                  <ng-autocomplete
                    [data]="travelerList"
                    [searchKeyword]="keyword"
                    (selected)='selectTraveler($event)'
                    (inputChanged)='getloadProfiles($event)'
                    (inputFocused)='onFocused($event)'
                    [itemTemplate]="itemTemplateProfiles"
                    (inputCleared)="searchCleared('traveler-list')"
                    [notFoundTemplate]="notFoundProfilesTemplate"
                    [debounceTime]="400"
                    [isLoading]="isLoadingTraveler"
                    [minQueryLength]="3"
                    placeHolder="{{form.ResourceTypeID == '' ? 'Select Business Profile first' : 'Search Traveler.'}}"
                    class="testing"
                    name="traveler"
                  >

                  </ng-autocomplete>

                  <ng-template #itemTemplateProfiles let-item>
                    <a href="javascript:void(0)">
                      <div class="auto-txtwrap">
                        <div class="autoicon">
                          <span class="fa" [ngClass]="{'fa-plane': item['glyph'] == 'airport', 'fa-map-marker': item['glyph'] == 'locality' }"></span>
                        </div>
                        <div class="autotxt">
                          <strong [innerHTML]="item.description"></strong><span>({{item.text}})</span>
                        </div>
                      </div>
                    </a>
                  </ng-template>

                  <ng-template #notFoundProfilesTemplate let-notFound>
                    {{errorMsg}}
                  </ng-template>
                  <div class="" *ngIf="error">
                    <label class="error">{{error.message}}</label>
                  </div>
  <!--                  <input type="text" placeholder="Select Business Profile First" class="form-control">-->
  <!--                  <span class="fa fa-paper-plane-o"></span>-->
              </div>
          </div>
        </div>
      </div>
    </div>


    <div class="custom-sidebar">
      <div class="custom-nav" id="tabsCustom">
        <ul>
          <li [ngClass]="{'active': tab == 'flight'}">
            <a href="javascript:void(0)" (click)="setSearchParams('flight')"><em class="plane-icon"></em> <span>Flight</span></a>
          </li>
          <li [ngClass]="{'active': tab == 'hotel'}">
            <a href="javascript:void(0)" (click)="setSearchParams('hotel')"><em class="hotel-icon"></em> <span>Hotel</span></a>
          </li>
          <li [ngClass]="{'active': tab == 'car'}">
            <a href="javascript:void(0)" (click)="setSearchParams('car')"><em class="car-icon"></em> <span>Car</span></a>
          </li>
          <li [ngClass]="{'active': tab == 'bundle'}">
            <a href="javascript:void(0)" (click)="setSearchParams('bundle')"><em class="template-icon"></em> <span>Templates</span></a>
          </li>
        </ul>
      </div>
    </div>
    <div class="custom-main">
          <ng-container *ngIf="tab == 'flight'">
            <div class="trip-radio-wrap">
              <div class="custom-control custom-radio custom-control-inline">
                  <input type="radio" id="Roundtrip" name="trip" class="custom-control-input">
                  <label class="custom-control-label" value="1" (click)="setTripType(1)" for="Roundtrip">Roundtrip</label>
              </div>
              <div class="custom-control custom-radio custom-control-inline">
                  <input type="radio" id="oneWay" value="2" [(ngModel)]="form.tripType"  name="trip" class="custom-control-input">
                  <label class="custom-control-label"  (click)="setTripType(2)" for="oneWay">One-Way</label>
              </div>
              <div class="custom-control custom-radio custom-control-inline">
                  <input type="radio" id="multiCity"  value="3" [(ngModel)]="form.tripType" name="trip" class="custom-control-input">
                  <label class="custom-control-label" (click)="setTripType(3)" for="multiCity">Multi-city</label>
              </div>
            </div>
            <div class="custom-content tabs-content" id="content-1" style="display: block;">
              <div class="book-time-wrap">
                <div class="row">
                  <div class="col-md-6">
                    <h3>Departure*</h3>
                    <div class="field-wrap-outer field-gray-wrap">
                      <div class="field-wrap">
                        <ng-autocomplete
                          [data]="departureList"
                          [searchKeyword]="keyword"
                          (selected)='selectDeparture($event)'
                          (inputChanged)='getServerResponse($event, "departure-list")'
                          (inputFocused)='onFocused($event)'
                          [itemTemplate]="departureListTemplate"
                          (inputCleared)="searchCleared('departure-list')"
                          [notFoundTemplate]="notFoundTemplate"
                          [debounceTime]="400"
                          [isLoading]="isLoadingResult"
                          [minQueryLength]="3"
                          placeHolder="Search Departure."
                          name="departure"
                        >
                        </ng-autocomplete>

                        <ng-template #departureListTemplate let-item>
                          <a href="javascript:void(0)">
                            <div class="auto-txtwrap">
                              <div class="autoicon">
                                <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                              </div>
                              <div class="autotxt">
                                <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                              </div>
                            </div>
                          </a>
                        </ng-template>

                        <ng-template #notFoundTemplate let-notFound>
                          {{errorMsg}}
                        </ng-template>
                        <div class="" *ngIf="error">
                          <label class="error">{{error.message}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <h3>Destination*</h3>
                    <div class="field-wrap-outer">
                      <div class="field-wrap time-picker-wrap field-gray-wrap">
                        <ng-autocomplete
                          [data]="arrivalList"
                          [searchKeyword]="keyword"
                          (selected)='selectArrival($event)'
                          (inputChanged)='getServerResponse($event, "arrival-list")'
                          (inputFocused)='onFocused($event)'
                          [itemTemplate]="itemTemplateRemote_"
                          (inputCleared)="searchCleared('arrival-list')"
                          [notFoundTemplate]="notFoundTemplate_"
                          [debounceTime]="400"
                          [isLoading]="isLoadingArrival"
                          [minQueryLength]="3"
                          placeHolder="Search Destination."
                          name="arrival"
                        >
                        </ng-autocomplete>

                        <ng-template #itemTemplateRemote_ let-item>
                          <a href="javascript:void(0)">
                            <div class="auto-txtwrap">
                              <div class="autoicon">
                                <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                              </div>
                              <div class="autotxt">
                                <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                              </div>
                            </div>
                          </a>
                        </ng-template>

                        <ng-template #notFoundTemplate_ let-notFound>
                          {{errorMsg}}
                        </ng-template>
                        <div class="" *ngIf="error">
                          <label class="error">{{error.message}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-7">
                    <div class="field-wrap-outer">
                      <label>Departure Date*</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.BeginDate"
                               bsDatepicker
                               [bsConfig]="bsConfig"
                               (ngModelChange)="setDateTo()"
                               [minDate]="minDateFrom"
                               placeholder="Departure Date"
                               name="departure_date"
                               class="form-control">
                        <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-5 col-7">
                    <div class="field-wrap-outer">
                      <label>Departure Time</label>
                      <div class="field-wrap time-picker-wrap">
                        <timepicker [(ngModel)]="form.BeginTime"
                                    [mousewheel]="true"
                                    [arrowkeys]="true"
                        ></timepicker>
                        <!--                        <input type="text" placeholder="" class="form-control">-->
                        <!--                        <span class="fa fa-clock-o"></span>-->
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-7">
                    <div class="field-wrap-outer">
                      <label>Return Date*</label>
                      <div class="field-wrap">
                          <input type="text"
                                 [(ngModel)]="form.EndDate"
                                 bsDatepicker
                                 [minDate]="form.BeginDate"
                                 [bsConfig]="bsConfig"
                                 placeholder="Return Date"
                                 name="arrival_date"
                                 class="form-control">
                          <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-5 col-7">
                    <div class="field-wrap-outer time-picker-wrap">
                      <label>Return Time</label>
                      <div class="field-wrap">
                          <timepicker [(ngModel)]="form.EndTime" [mousewheel]="true" [arrowkeys]="true"></timepicker>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row" *ngIf="state.errors != ''">
                  <div class="col-sm-12">
                      <p class="error">{{state.errors}}</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="reservation-bot-btns d-flex">
              <a href="#" class="btn btn-secondary"><span class="fa fa-angle-left"></span> Back</a>
              <button type="submit" class="btn btn-success ml-auto" (click)="submitIt()" [disabled]="state.processing">Next <span class="fa fa-angle-right"></span> <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>
            </div>

            <!-- <button type="submit" class="btn btn-success btn-block" (click)="submitIt()" [disabled]="state.processing">Search <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button> -->
          </ng-container>

          <ng-container *ngIf="tab == 'hotel'">
            <div class="custom-content tabs-content" id="content-2" style="display: block;">
              <div class="book-time-wrap">
                <div class="row">
                  <div class="col-md-12">
                    <h3>Location*</h3>
                    <div class="field-wrap-outer field-gray-wrap">
                      <div class="field-wrap">
                        <ng-autocomplete
                          [data]="departureList"
                          [searchKeyword]="keyword"
                          (selected)='selectDeparture($event)'
                          (inputChanged)='getServerResponse($event, "departure-list")'
                          (inputFocused)='onFocused($event)'
                          [itemTemplate]="departureListTemplate"
                          (inputCleared)="searchCleared('departure-list')"
                          [notFoundTemplate]="notFoundTemplate"
                          [debounceTime]="400"
                          [isLoading]="isLoadingResult"
                          [minQueryLength]="3"
                          placeHolder="Search Departure."
                          name="departure"
                        >
                        </ng-autocomplete>

                        <ng-template #departureListTemplate let-item>
                          <a href="javascript:void(0)">
                            <div class="auto-txtwrap">
                              <div class="autoicon">
                                <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                              </div>
                              <div class="autotxt">
                                <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                              </div>
                            </div>
                          </a>
                        </ng-template>

                        <ng-template #notFoundTemplate let-notFound>
                          {{errorMsg}}
                        </ng-template>
                        <div class="" *ngIf="error">
                          <label class="error">{{error.message}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">

                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="field-wrap-outer">
                      <label>Single/Double Occupancy</label>
                      <div class="field-wrap">
                        <input type="text" value="1" class="form-control no-icon">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="field-wrap-outer time-picker-wrap">
                      <label>Number of Rooms</label>
                      <div class="field-wrap">
                        <input type="text"  value="1" class="form-control no-icon">
                      </div>
                      </div>
                    </div>
                  </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="field-wrap-outer">
                      <label>Arrival Date*</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.BeginDate"
                               bsDatepicker
                               [bsConfig]="bsConfig"
                               (ngModelChange)="setDateTo()"
                               [minDate]="minDateFrom"
                               placeholder="Departure Date"
                               name="departure_date"
                               class="form-control">
                        <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="field-wrap-outer">
                      <label>Departure</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.EndDate"
                               bsDatepicker
                               [minDate]="form.BeginDate"
                               [bsConfig]="bsConfig"
                               placeholder="Return Date"
                               name="arrival_date"
                               class="form-control">
                        <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="field-wrap-outer">
                      <label>Hotel Name</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.hotelName"
                               placeholder="Hotel Name"
                               name="hotel_name"
                               class="form-control no-icon">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="field-wrap-outer time-picker-wrap">
                      <label>Hotel Chain</label>
                      <div class="field-wrap">
                        <input type="text" [(ngModel)]="form.hotelChain" placeholder="Hotel Name" name="hotel_name" class="form-control no-icon">
                      </div>
                      </div>
                    </div>
                  </div>
                <div class="row" *ngIf="state.errors != ''">
                  <div class="col-sm-12">
                    <p class="error">{{state.errors}}</p>
                  </div>
                </div>
              </div>
              <button type="submit" class="btn btn-success btn-block" (click)="submitIt()" [disabled]="state.processing">Search <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>
            </div>
          </ng-container>
          <ng-container *ngIf="tab == 'car'">
            <div class="custom-content tabs-content" id="content-3" style="display: block;">
              <div class="book-time-wrap">
                <div class="row">
                  <div class="col-md-6">
                    <h3>Pickup Location*</h3>
                    <div class="field-wrap-outer field-gray-wrap">
                      <div class="field-wrap">
                        <ng-autocomplete
                          [data]="departureList"
                          [searchKeyword]="keyword"
                          (selected)='selectDeparture($event)'
                          (inputChanged)='getServerResponse($event, "departure-list")'
                          (inputFocused)='onFocused($event)'
                          [itemTemplate]="departureListTemplate"
                          (inputCleared)="searchCleared('departure-list')"
                          [notFoundTemplate]="notFoundTemplate"
                          [debounceTime]="400"
                          [isLoading]="isLoadingResult"
                          [minQueryLength]="3"
                          placeHolder="Pickup Location"
                          name="departure"
                        >
                        </ng-autocomplete>

                        <ng-template #departureListTemplate let-item>
                          <a href="javascript:void(0)">
                            <div class="auto-txtwrap">
                              <div class="autoicon">
                                <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                              </div>
                              <div class="autotxt">
                                <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                              </div>
                            </div>
                          </a>
                        </ng-template>

                        <ng-template #notFoundTemplate let-notFound>
                          {{errorMsg}}
                        </ng-template>
                        <div class="" *ngIf="error">
                          <label class="error">{{error.message}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <h3>DropOff Location*</h3>
                    <div class="field-wrap-outer">
                      <div class="field-wrap time-picker-wrap field-gray-wrap">
                        <ng-autocomplete
                          [data]="arrivalList"
                          [searchKeyword]="keyword"
                          (selected)='selectArrival($event)'
                          (inputChanged)='getServerResponse($event, "arrival-list")'
                          (inputFocused)='onFocused($event)'
                          [itemTemplate]="itemTemplateRemote_"
                          (inputCleared)="searchCleared('arrival-list')"
                          [notFoundTemplate]="notFoundTemplate_"
                          [debounceTime]="400"
                          [isLoading]="isLoadingArrival"
                          [minQueryLength]="3"
                          placeHolder="DropOff Location"
                          name="arrival"
                        >
                        </ng-autocomplete>

                        <ng-template #itemTemplateRemote_ let-item>
                          <a href="javascript:void(0)">
                            <div class="auto-txtwrap">
                              <div class="autoicon">
                                <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                              </div>
                              <div class="autotxt">
                                <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                              </div>
                            </div>
                          </a>
                        </ng-template>

                        <ng-template #notFoundTemplate_ let-notFound>
                          {{errorMsg}}
                        </ng-template>
                        <div class="" *ngIf="error">
                          <label class="error">{{error.message}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-7">
                    <div class="field-wrap-outer">
                      <label>Pickup Date*</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.BeginDate"
                               bsDatepicker
                               [bsConfig]="bsConfig"
                               (ngModelChange)="setDateTo()"
                               [minDate]="minDateFrom"
                               placeholder="Departure Date"
                               name="departure_date"
                               class="form-control">
                        <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-5 col-7">
                    <div class="field-wrap-outer">
                      <label>Pickup Time</label>
                      <div class="field-wrap time-picker-wrap">
                        <timepicker [(ngModel)]="form.BeginTime"
                                    [mousewheel]="true"
                                    [arrowkeys]="true"
                        ></timepicker>
                        <!--                        <input type="text" placeholder="" class="form-control">-->
                        <!--                        <span class="fa fa-clock-o"></span>-->
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-7">
                    <div class="field-wrap-outer">
                      <label>Return Date*</label>
                      <div class="field-wrap">
                        <input type="text"
                               [(ngModel)]="form.EndDate"
                               bsDatepicker
                               [minDate]="form.BeginDate"
                               [bsConfig]="bsConfig"
                               placeholder="Return Date"
                               name="arrival_date"
                               class="form-control">
                        <span class="fa fa-calendar-o"></span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-5 col-7">
                    <div class="field-wrap-outer time-picker-wrap">
                      <label>Return Time</label>
                      <div class="field-wrap">
                        <timepicker [(ngModel)]="form.EndTime" [mousewheel]="true" [arrowkeys]="true"></timepicker>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row" *ngIf="state.errors != ''">
                  <div class="col-sm-12">
                    <p class="error">{{state.errors}}</p>
                  </div>
                </div>
              </div>
              <button type="submit" class="btn btn-success btn-block" (click)="submitIt()" [disabled]="state.processing">Search <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>
            </div>
          </ng-container>

          <ng-container *ngIf="tab == 'bundle'">
            <div class="custom-content tabs-content" id="content-4" style="display: block;">
              <div class="book-time-wrap">

                <div class="tabs-secondary">
                  <ul>
                    <li [ngClass]="{'active': bundle == 1}">
                      <a href="javascript:void(0);" (click)="bundle = 1" > <span class="flight-hotel d-block ml-auto mr-auto"></span> <strong>Flight + Hotel</strong></a>
                    </li>
                    <li [ngClass]="{'active': bundle == 2}">
                      <a href="javascript:void(0);" (click)="bundle = 2"> <span class="flight-car d-block ml-auto mr-auto"></span> <strong>Flight + Car</strong></a>
                    </li>
                    <li [ngClass]="{'active': bundle == 3}">
                      <a href="javascript:void(0);"  (click)="bundle = 3"> <span class="flight-car-hotel d-block ml-auto mr-auto"></span> <strong>Flight + Car + Hotel</strong></a>
                    </li>
                    <li [ngClass]="{'active': bundle == 4}">
                      <a href="javascript:void(0);" (click)="bundle = 4"> <span class="bundle-icon d-block ml-auto mr-auto"></span> <strong>Bundle</strong></a>
                    </li>
                  </ul>
                </div>
                <div class="secondary-content-wrap">
                  <ng-container *ngIf="bundle == 1">
                    <div class="secondary-content" id="tab-1">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>From</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                [data]="departureList"
                                [searchKeyword]="keyword"
                                (selected)='selectDeparture($event)'
                                (inputChanged)='getServerResponse($event, "departure-list")'
                                (inputFocused)='onFocused($event)'
                                [itemTemplate]="departureListTemplate"
                                (inputCleared)="searchCleared('departure-list')"
                                [notFoundTemplate]="notFoundTemplate"
                                [debounceTime]="400"
                                [isLoading]="isLoadingResult"
                                [minQueryLength]="3"
                                placeHolder="From*"
                                name="departure"
                              >
                              </ng-autocomplete>

                              <ng-template #departureListTemplate let-item>
                                <a href="javascript:void(0)">
                                  <div class="auto-txtwrap">
                                    <div class="autoicon">
                                      <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                    </div>
                                    <div class="autotxt">
                                      <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                    </div>
                                  </div>
                                </a>
                              </ng-template>

                              <ng-template #notFoundTemplate let-notFound>
                                {{errorMsg}}
                              </ng-template>
                              <div class="" *ngIf="error">
                                <label class="error">{{error.message}}</label>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer">
                            <label>To</label>
                            <div class="field-wrap time-picker-wrap field-gray-wrap">
                              <ng-autocomplete
                                [data]="arrivalList"
                                [searchKeyword]="keyword"
                                (selected)='selectArrival($event)'
                                (inputChanged)='getServerResponse($event, "arrival-list")'
                                (inputFocused)='onFocused($event)'
                                [itemTemplate]="itemTemplateRemote_"
                                (inputCleared)="searchCleared('arrival-list')"
                                [notFoundTemplate]="notFoundTemplate_"
                                [debounceTime]="400"
                                [isLoading]="isLoadingArrival"
                                [minQueryLength]="3"
                                placeHolder="To*"
                                name="arrival"
                              >
                              </ng-autocomplete>

                              <ng-template #itemTemplateRemote_ let-item>
                                <a href="javascript:void(0)">
                                  <div class="auto-txtwrap">
                                    <div class="autoicon">
                                      <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                    </div>
                                    <div class="autotxt">
                                      <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                    </div>
                                  </div>
                                </a>
                              </ng-template>

                              <ng-template #notFoundTemplate_ let-notFound>
                                {{errorMsg}}
                              </ng-template>
                              <div class="" *ngIf="error">
                                <label class="error">{{error.message}}</label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Hotel Name</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                placeHolder="Hotel Name"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Hotel Chain</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                placeHolder="Hotel Chain"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Single/Double Occupancy</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                              value="1"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Number of Rooms</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                value="1"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-7">
                          <div class="field-wrap-outer">
                            <label>Departure Date*</label>
                            <div class="field-wrap">
                              <input type="text"
                                     [(ngModel)]="form.BeginDate"
                                     bsDatepicker
                                     [bsConfig]="bsConfig"
                                     (ngModelChange)="setDateTo()"
                                     [minDate]="minDateFrom"
                                     placeholder="Departure Date"
                                     name="departure_date"
                                     class="form-control">
                              <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-5 col-7">
                          <div class="field-wrap-outer">
                            <label>Departure Start Time</label>
                            <div class="field-wrap time-picker-wrap">
                              <timepicker [(ngModel)]="form.BeginTime"
                                          [mousewheel]="true"
                                          [arrowkeys]="true"
                              ></timepicker>
                              <!--                        <input type="text" placeholder="" class="form-control">-->
                              <!--                        <span class="fa fa-clock-o"></span>-->
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-7">
                          <div class="field-wrap-outer">
                            <label>Return Date*</label>
                            <div class="field-wrap">
                                <input type="text"
                                       [(ngModel)]="form.EndDate"
                                       bsDatepicker
                                       [minDate]="form.BeginDate"
                                       [bsConfig]="bsConfig"
                                       placeholder="Return Date"
                                       name="arrival_date"
                                       class="form-control">
                                <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-5 col-7">
                          <div class="field-wrap-outer time-picker-wrap">
                            <label>Return End Time</label>
                            <div class="field-wrap">
                                <timepicker [(ngModel)]="form.EndTime" [mousewheel]="true" [arrowkeys]="true"></timepicker>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div><!-- tab-1 -->
                  </ng-container>
                  <ng-container *ngIf="bundle == 2">
                    <div class="secondary-content" id="tab-2">

                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>From</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                placeHolder="From*"
                              >
                              </ng-autocomplete>

                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer">
                            <label>To</label>
                            <div class="field-wrap time-picker-wrap field-gray-wrap">
                              <ng-autocomplete
                                placeHolder="To*"
                              >
                              </ng-autocomplete>

                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6 col-12">
                          <div class="field-wrap-outer">
                            <label>Departure*</label>
                            <div class="field-wrap">
                              <input type="text"
                                     [(ngModel)]="form.BeginDate"
                                     bsDatepicker
                                     [bsConfig]="bsConfig"
                                     (ngModelChange)="setDateTo()"
                                     [minDate]="minDateFrom"
                                     placeholder="Departure Date"
                                     name="departure_date"
                                     class="form-control">
                              <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6 col-12">
                          <div class="field-wrap-outer">
                            <label>Return Date*</label>
                            <div class="field-wrap">
                                <input type="text"
                                       [(ngModel)]="form.EndDate"
                                       bsDatepicker
                                       [minDate]="form.BeginDate"
                                       [bsConfig]="bsConfig"
                                       placeholder="Return Date"
                                       name="arrival_date"
                                       class="form-control">
                                <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                      </div>


                    </div><!-- tab-2 -->
                  </ng-container>
                  <ng-container *ngIf="bundle == 3">
                    <div class="secondary-content" id="tab-3">

                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>From</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                [data]="departureList"
                                [searchKeyword]="keyword"
                                (selected)='selectDeparture($event)'
                                (inputChanged)='getServerResponse($event, "departure-list")'
                                (inputFocused)='onFocused($event)'
                                [itemTemplate]="departureListTemplate"
                                (inputCleared)="searchCleared('departure-list')"
                                [notFoundTemplate]="notFoundTemplate"
                                [debounceTime]="400"
                                [isLoading]="isLoadingResult"
                                [minQueryLength]="3"
                                placeHolder="From*"
                                name="departure"
                              >
                              </ng-autocomplete>

                              <ng-template #departureListTemplate let-item>
                                <a href="javascript:void(0)">
                                  <div class="auto-txtwrap">
                                    <div class="autoicon">
                                      <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                    </div>
                                    <div class="autotxt">
                                      <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                    </div>
                                  </div>
                                </a>
                              </ng-template>

                              <ng-template #notFoundTemplate let-notFound>
                                {{errorMsg}}
                              </ng-template>
                              <div class="" *ngIf="error">
                                <label class="error">{{error.message}}</label>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer">
                            <label>To</label>
                            <div class="field-wrap time-picker-wrap field-gray-wrap">
                              <ng-autocomplete
                                [data]="arrivalList"
                                [searchKeyword]="keyword"
                                (selected)='selectArrival($event)'
                                (inputChanged)='getServerResponse($event, "arrival-list")'
                                (inputFocused)='onFocused($event)'
                                [itemTemplate]="itemTemplateRemote_"
                                (inputCleared)="searchCleared('arrival-list')"
                                [notFoundTemplate]="notFoundTemplate_"
                                [debounceTime]="400"
                                [isLoading]="isLoadingArrival"
                                [minQueryLength]="3"
                                placeHolder="To*"
                                name="arrival"
                              >
                              </ng-autocomplete>

                              <ng-template #itemTemplateRemote_ let-item>
                                <a href="javascript:void(0)">
                                  <div class="auto-txtwrap">
                                    <div class="autoicon">
                                      <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                    </div>
                                    <div class="autotxt">
                                      <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                    </div>
                                  </div>
                                </a>
                              </ng-template>

                              <ng-template #notFoundTemplate_ let-notFound>
                                {{errorMsg}}
                              </ng-template>
                              <div class="" *ngIf="error">
                                <label class="error">{{error.message}}</label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Hotel Name</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                placeHolder="Hotel Name"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Hotel Chain</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                placeHolder="Hotel Chain"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Single/Double Occupancy</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                              value="1"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="field-wrap-outer field-gray-wrap">
                            <label>Number of Rooms</label>
                            <div class="field-wrap">
                              <ng-autocomplete
                                value="1"
                              >
                              </ng-autocomplete>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-7">
                          <div class="field-wrap-outer">
                            <label>Departure Date*</label>
                            <div class="field-wrap">
                              <input type="text"
                                     [(ngModel)]="form.BeginDate"
                                     bsDatepicker
                                     [bsConfig]="bsConfig"
                                     (ngModelChange)="setDateTo()"
                                     [minDate]="minDateFrom"
                                     placeholder="Departure Date"
                                     name="departure_date"
                                     class="form-control">
                              <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-5 col-7">
                          <div class="field-wrap-outer">
                            <label>Departure Start Time</label>
                            <div class="field-wrap time-picker-wrap">
                              <timepicker [(ngModel)]="form.BeginTime"
                                          [mousewheel]="true"
                                          [arrowkeys]="true"
                              ></timepicker>
                              <!--                        <input type="text" placeholder="" class="form-control">-->
                              <!--                        <span class="fa fa-clock-o"></span>-->
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-7">
                          <div class="field-wrap-outer">
                            <label>Return Date*</label>
                            <div class="field-wrap">
                                <input type="text"
                                       [(ngModel)]="form.EndDate"
                                       bsDatepicker
                                       [minDate]="form.BeginDate"
                                       [bsConfig]="bsConfig"
                                       placeholder="Return Date"
                                       name="arrival_date"
                                       class="form-control">
                                <span class="fa fa-calendar-o"></span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-5 col-7">
                          <div class="field-wrap-outer time-picker-wrap">
                            <label>Return End Time</label>
                            <div class="field-wrap">
                                <timepicker [(ngModel)]="form.EndTime" [mousewheel]="true" [arrowkeys]="true"></timepicker>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div><!-- tab-3 -->
                  </ng-container>
                  <ng-container *ngIf="bundle == 4">
                    <div class="secondary-content" id="tab-4">

                      <div class="mb-4">
                        <select class="custom-select custom-select-normal" [(ngModel)]="state.bundle.templateId" (change)="loadTemplateDefinition()">
                          <option value="{{template.id || '00000000-0000-0000-0000-000000000000'}}" *ngFor="let template of state.templateList">{{template.name}}</option>
                        </select>
                      </div>

                      <div class="input-group mb-4" *ngIf=" state.bundle.templateId == '879340fd-382e-4c63-8f2d-489b57e7e134'">
                        <select class="custom-select custom-select-normal" [(ngModel)]="state.bundle.resourceType">
                          <option value="0">None</option>
                          <option value="1">Commercial Flight</option>
                          <option value="2">Hotel</option>
                          <option value="3">Rental Car</option>
                        </select>
                        <div class="input-group-append">
                          <button class="btn btn-success" type="button" (click)="pushItemToBundle()"> <span class="fa fa-plus"></span> Add</button>
                        </div>
                      </div>


                    <div class="accordion accordion-sm custom-accordion" id="accordionExample">
                      <div class="mb-3" id="accordion_{{i}}" *ngFor="let item of state.bundle.template; let i=index">
                        <div class="card-header" id="heading_{{i}}">
                          <h2 class="accordion-link" aria-expanded="false" [attr.data-toggle]="'collapse'" [attr.data-target]="'#collaps-'+i" [attr.aria-expanded]="'true'">
                            {{item.title}}
                            <a href="javascript:void(0)" (click)="removeBlock(i)" class="fa fa-trash-o remove-accordion"></a>
                          </h2>
                        </div>

                        <div id="collaps-{{i}}" class="collapse" [ngClass]="{'show': item.isOpen}" [attr.data-parent]="'#accordionExample'">
                          <div class="box box-lr">

                            <div class="row">
                              <div class="col-md-7">
                                <div class="field-wrap-outer">
                                  <label>Departure Date*</label>
                                  <div class="field-wrap">
                                    <input type="text"
                                           [(ngModel)]="form.BeginDate"
                                           bsDatepicker
                                           [bsConfig]="bsConfig"
                                           (ngModelChange)="setDateTo()"
                                           [minDate]="minDateFrom"
                                           placeholder="Departure Date"
                                           name="departure_date"
                                           class="form-control">
                                    <span class="fa fa-calendar-o"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col-md-5 col-7">
                                <div class="field-wrap-outer">
                                  <label>Departure Time</label>
                                  <div class="field-wrap time-picker-wrap">
                                    <timepicker [(ngModel)]="form.BeginTime"
                                                [mousewheel]="true"
                                                [arrowkeys]="true"
                                    ></timepicker>
                                    <!--                        <input type="text" placeholder="" class="form-control">-->
                                    <!--                        <span class="fa fa-clock-o"></span>-->
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="row">
                              <div class="col-md-6">
                                <div class="field-wrap-outer field-gray-wrap">
                                  <div class="field-wrap">
                                    <ng-autocomplete
                                      [data]="departureList"
                                      [searchKeyword]="keyword"
                                      (selected)='selectDeparture($event)'
                                      (inputChanged)='getServerResponse($event, "departure-list")'
                                      (inputFocused)='onFocused($event)'
                                      [itemTemplate]="departureListTemplate"
                                      (inputCleared)="searchCleared('departure-list')"
                                      [notFoundTemplate]="notFoundTemplate"
                                      [debounceTime]="400"
                                      [isLoading]="isLoadingResult"
                                      [minQueryLength]="3"
                                      placeHolder="Departure"
                                      name="departure"
                                    >
                                    </ng-autocomplete>

                                    <ng-template #departureListTemplate let-item>
                                      <a href="javascript:void(0)">
                                        <div class="auto-txtwrap">
                                          <div class="autoicon">
                                            <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                          </div>
                                          <div class="autotxt">
                                            <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                          </div>
                                        </div>
                                      </a>
                                    </ng-template>

                                    <ng-template #notFoundTemplate let-notFound>
                                      {{errorMsg}}
                                    </ng-template>
                                    <div class="" *ngIf="error">
                                      <label class="error">{{error.message}}</label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="field-wrap-outer">
                                  <div class="field-wrap time-picker-wrap field-gray-wrap">
                                    <ng-autocomplete
                                      [data]="arrivalList"
                                      [searchKeyword]="keyword"
                                      (selected)='selectArrival($event)'
                                      (inputChanged)='getServerResponse($event, "arrival-list")'
                                      (inputFocused)='onFocused($event)'
                                      [itemTemplate]="itemTemplateRemote_"
                                      (inputCleared)="searchCleared('arrival-list')"
                                      [notFoundTemplate]="notFoundTemplate_"
                                      [debounceTime]="400"
                                      [isLoading]="isLoadingArrival"
                                      [minQueryLength]="3"
                                      placeHolder="Arrival"
                                      name="arrival"
                                    >
                                    </ng-autocomplete>

                                    <ng-template #itemTemplateRemote_ let-item>
                                      <a href="javascript:void(0)">
                                        <div class="auto-txtwrap">
                                          <div class="autoicon">
                                            <span class="fa" [ngClass]="{'fa-plane': item.glyph == 'airport', 'fa-map-marker': item.glyph == 'locality' }"></span>
                                          </div>
                                          <div class="autotxt">
                                            <strong [innerHTML]="item.text"></strong><span>({{item.description}})</span>
                                          </div>
                                        </div>
                                      </a>
                                    </ng-template>

                                    <ng-template #notFoundTemplate_ let-notFound>
                                      {{errorMsg}}
                                    </ng-template>
                                    <div class="" *ngIf="error">
                                      <label class="error">{{error.message}}</label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div><!-- tab-1 -->
                  </ng-container>
                </div><!-- secondary-content-wrap -->

              </div>
              <button type="submit" class="btn btn-info btn-block" (click)="submitIt()" [disabled]="state.processing">Search <span class="fa fa-spin fa-spinner" *ngIf="state.processing"></span></button>
            </div>
          </ng-container>
    </div>
  </div>
</div>


<script src="/assets/js/reservation.js" defer></script>
